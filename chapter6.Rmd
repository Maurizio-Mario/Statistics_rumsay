---
title: 'Rumsay, Chapter 6: Measures of relative standing and the normal distribution.
  [Ongoing]'
author: "Maurizio Murino"
date: "12 March 2016"
output: html_document
---

```{r setoption, cache=TRUE, warning=FALSE, message=FALSE, fig.width=12}
knitr::opts_chunk$set(cache=TRUE, warning=FALSE, message=FALSE, fig.width=12)
```

```{r, loadlattice}
library(lattice)
library(knitr)
```

### Exercise 1 - 12/3/'16

What do you guess are the standard deviations of the two distributions in the figure below?

```{r 1.1 dataload1, echo=FALSE}

set.seed(123)
e1a <- seq(10, 70,length = 10000)
e1b <- dnorm(e1a, mean = 40, sd = 8)
```

```{r plot 1}
plote1 <- xyplot(e1b ~ e1a,
       type = "l",
       horizontal = FALSE,
       scales = list(y = list(at = NULL)),
       main = "Normal distribution, mean: 40, ds: 8, range: 10-70",
       panel = function(x, ...) {
               panel.xyplot(x, ...)
               vlines <- c(32, 40, 48)
               panel.abline( v = vlines, lty = 3)
       })
```     

```{r dataload 2, echo=FALSE}
set.seed(123)
e1c <- seq(10, 70,length = 10000)
e1d <- dnorm(e1c, mean = 40, sd = 4)
```

```{r plot2}
plote2 <- xyplot(e1d ~ e1c,
       type = "l",
       horizontal = FALSE,
       scales = list(y = list(at = NULL)),
       main = "Normal distribution, mean: 40, ds: 4, range: 10-70",
       panel = function(x, ...) {
               panel.xyplot(x, ...)
               vlines <- c(36, 40, 44)
               panel.abline( v = vlines, lty = 3)
       })

## position: (a, b, c, d) b: height from the top; d: height from the bottom

print(plote1, position=c(0, .5, 1, 1), more=TRUE)
print(plote2, position=c(0, 0, 1, .5))
```

__Solution:__ 

In the second plot, the standard deviation is slighly smaller than the first's.

### Exercise 2 - 15/3/'16

Draw a picture of a normal distribution with mean 70 and standard deviation 5.

```{r2.1  data load, echo=FALSE}

e2a <- seq(0, 140, length = 10000)
e2b <- dnorm(e2a, 70, 15)                  
```

```{r2.2 plot}
xyplot(e2b ~ e2a,
       type = "l",
       main = "Normal distribution, mean 70",
       scales = list(y = list(at = NULL), x = list(at = seq(0, 140, 10))),
       panel = function(x, ...){
               panel.xyplot(x, ...)
               vmean <- 70
               panel.abline(v = vmean, lty = 4)
               
       })
```

### Exercise 3 - 24/3/'16

Draw a picture with two normal distributions. Give each a mean of 70, with standard deviations of 5 and 10. How do the distributions differ?

```{R 3.1 plots}
e3a <- seq(40, 100, length = 1000)
e3b <- dnorm(e3a, 70, 5)
plot_e3a <- xyplot(e3b ~ e3a,
                   type = "l",
                   main = "Plot 1 - Mean 70, sd 5")

e3c <- seq(40, 100, length = 1000)
e3d <- dnorm(e3a, 70, 10)
plot_e3b <- xyplot(e3d ~ e3c,
                   type = "l",
                   main = "Plot 2 - Mean 70, sd 10",
                   ylim = range(e3b))
                   

print(plot_e3a, position = c(0, .5, 1, 1), more = TRUE)
print(plot_e3b, position = c(0, 0, 1, 0.5))
```

_Solution:_ 

The second distribution is more widely scattered around the mean that, hence, result a little smaller.

### Exercise 4 - 25/3/'16

Have a normal distribution with mean 110 and standard deviation 15. 

```{r 4.1}
e4a <- seq(60, 170, length = 10000)
e4b <- dnorm(e4a, 110, 15)

plot_e4a <- xyplot(e4b ~ e4a,
       type = "l",
       main = "Plot 1",
       scales = list(x = list(at = seq(60, 170, 10)), rot = 45),
       panel = function(x, ...){
               panel.xyplot(x, ...)
               panel.abline(v = 110, lty = 2)
       })

plot_e4b <- xyplot(e4b ~ e4a,
       type = "l",
       main = "Plot 2",
       scales = list(x = list(at = seq(60, 170, 10)), rot = 45),
       panel = function(x,y, ...){
               panel.xyplot(x,y, ...)
               panel.abline( v = c(110, 125), lty = 2)
               
               xx <- c(110, x[x>=110 & x<=125], 125) 
               yy <- c(0,   y[x>=110 & x<=125], 0) 
               panel.polygon(xx,yy, ..., col='red')
       })

plot_e4c <- xyplot(e4b ~ e4a,
       type = "l",
       main = "Plot 3",
       scales = list(x = list(at = seq(60, 170, 10)), rot = 45),
       panel = function(x,y, ...){
               panel.xyplot(x,y, ...)
               panel.abline( v = c(95, 110, 140), lty = 2)
               
               xx <- c(95, x[x>=95 & x<=140], 140) 
               yy <- c(0,   y[x>=95 & x<=140], 0) 
               panel.polygon(xx,yy, ..., col='red')
       })

plot_e4d <- xyplot(e4b ~ e4a,
       type = "l",
       main = "Plot 4",
       scales = list(x = list(at = seq(60, 170, 10)), rot = 45),
       panel = function(x,y, ...){
               panel.xyplot(x,y, ...)
               panel.abline( v = c(80, 95, 110), lty = 2)
               
               xx <- c(85, x[x>=80 & x<=95], 95) 
               yy <- c(0,   y[x>=80 & x<=95], 0) 
               panel.polygon(xx,yy, ..., col='red')
       })

print(plot_e4a, split = c(1, 1, 2, 2), more = TRUE)
print(plot_e4b, split = c(2, 1, 2, 2), more = TRUE)
print(plot_e4c, split = c(1, 2, 2, 2), more = TRUE)
print(plot_e4d, split = c(2, 2, 2, 2), more = FALSE)

```

__A. About what percentage of the values lie between 110 and 125?__

Between 110 and 125 we have approximately the 34% of the observations.

__B. About what percentage of the values lie between 95 and 140?__

Between 95 and 140 there are approximately the 81% of the observations.

__C. About what percentage of the values lie between 80 and 95?__ 

Between 80 and 95 we should expect about the 12% of the observations.

### Exercise 5 - 30/3/'16

Exam scores have a normal distribution with mean of 70 and standard deviation of 10. Bob's score is 80. Find and intepret his standard score. 

```{r 5.1}
e5a <- seq(30, 110, length = 1000)
e5b <- dnorm(e5a, 70, 10)

e5c <- seq(-3, 3, length = 1000)
e5d <- dnorm(e5c, mean = 0, sd = 1)

# Bob's Z-score:
(80 - 70)/10
```

__Solution:__ 

Bob's Z-score is 1, that is, exactly one standard deviation from the mean.

```{r 5.2 plots}

plot_e5a <- xyplot(e5b ~ e5a, 
                  type = "l",
                  main = "Bob's score",
                  panel = function(x, ...){
                          panel.xyplot(x, ...)
                          panel.abline(v = c(70, 80), lty = c(1, 2))
                          panel.text(lab = c("Mean", "Bob"), x = c(70, 80), y = 0.035, 
                adj = c(0.4, 0), cex = 1.5, srt = 45)
                  })


plot_e5b <- xyplot(e5d ~ e5c, 
                  type = "l",
                  main = "Bob's standardized score",
                  panel = function(x, ...){
                          panel.xyplot(x, ...)
                          panel.abline(v = c(0, 1), lty = c(1, 2))
                          panel.text(lab = c("Mean", "Bob"), x = c(0, 1), y = 0.35, 
                adj = c(0.4, 0), cex = 1.5, srt = 45)
                  })

print(plot_e5a, split = c(1, 1, 1, 2), more = TRUE)
print(plot_e5b, split = c(1, 2, 1, 2), more = FALSE)
dev.off()
```

### Exercise 6 - 4/4/'16

Bob scores 80 on both his math exam (which has a mean of 70 and standard deviation on 10) and his English exam (which has a mean of 85 and a standard deviation of 5). Find and interpret Bob's z-scores on both exams to let him know wich exam (if either) he did better on.

```{r 6.1 dataload}
e6a <- seq(0, 100, length = 1000)
e6b <- dnorm(e6a, mean = 70, sd = 10)

e6c <- seq(0, 100, length = 1000)
e6d <- dnorm(e6c, mean = 85, sd = 5)
```

```{r 6.2 plots}
plot_e6a <- xyplot(e6b ~ e6a,
                   type = "l",
                   main = "Math exam",
                   ylim = range(range(e6d)),
                   panel = function(x, ...){
                           panel.xyplot(x, ...)
                           panel.abline(v = c(70, 80), lty = c(2, 3))
                           panel.text(lab = c("Mean", "Bob"), x = c(70, 80), y = 0.03, 
                adj = c(0.2, 0), cex = 1.5, srt = 90)
                           })

plot_e6b <- xyplot(e6d ~ e6c,
                   type = "l",
                   main = "English exam",
                   panel = function(x, ...){
                           panel.xyplot(x, ...)
                           panel.abline(v = c(85, 80), lty = c(2, 3))
                           panel.text(lab = c("Mean", "Bob"), x = c(85, 80), y = 0.03, 
                adj = c(0.4, 0), cex = 1.5, srt = 90)
                           })
print(plot_e6a, split = c(1, 1, 1, 2), more = TRUE)
print(plot_e6b, split = c(1, 2, 1, 2), more = FALSE)
```

Now lets draw the standard normal distibution of the exams and the standardized results of Bob. For the math exam, the standardized score for Bob is `r (80-70)/10` and `r (80-85)/5` for the other. 
Bob had a worst result in the second exam.

```{r 6.3 plot standard normal}
e6e <- seq(-3, 3, length = 1000)
e6f <- dnorm(e6e, 0, 1)

plot_e6c <- xyplot(e6f ~ e6e, 
                   type = "l",
                   main = "Math standardized scores",
                   panel = function(x, ...){
                           panel.xyplot(x, ...)
                           panel.abline(v = 0, lty = 2)
                           panel.text(lab = "Mean and Bob", x = 0, y = 0.2, adj = c(0.3, -0.2), cex = 1.3, srt = 45)
                   })

plot_e6d <- xyplot(e6f ~ e6e, 
                   type = "l",
                   main = "English standardized scores",
                   panel = function(x, ...){
                           panel.xyplot(x, ...)
                           panel.abline(v = c(0, -1), lty = c(2, 3))
                           panel.text(lab = c("Mean", "Bob"), x = c(0, -1 ), y = 0.25, adj = c(0.4, -0.2), cex = 1.3, srt = 90)
                   })

print(plot_e6c, split = c(1, 1, 1, 2), more = TRUE)
print(plot_e6d, split = c(1, 2, 1, 2), more = FALSE)
```

### Exercise 7 - 5/4/'16

Sue's math class has a mean of 70 with a standard deviation of 5. Her standard score is -2. What is her original score?

```{r 7.1 dataload}
e7a <- seq(-3, 3, length = 1000)
e7b <- dnorm(e7a, 0, 1)
e7c <- seq(0, 100, length = 1000)
e7d <- dnorm(e7c, 70, 5)

plot_e7a <- xyplot(e7b ~ e7a,
                   type = "l",
                   main = "Sue's standard math score",
                   panel = function(x, ...){
                           panel.xyplot(x, ...)
                           panel.abline(v = c(0, -2), lty = c(2, 3))
                           panel.text(lab = c("Mean", "Sue"), x = c(0, -2), y = 0.03, adj = c(0.4, 0), cex = 1.2, srt = 45)
                   })

plot_e7b <- xyplot(e7d ~ e7c,
                   type = "l",
                   main = "Sue's math result",
                   scales = list(y = list(at = seq(0, 0.4, 0.1))),
                   panel = function(x, ...){
                           panel.xyplot(x, ...)
                           panel.abline(v = c(70, 60), lty = c(2, 3))
                           panel.text(lab = c("Mean", "Sue"), x = c(70, 60), y = 0.03, adj = c(0.4, 0), cex = 1.2, srt = 45)
                   })

print(plot_e7a, split = c(1, 1, 1, 2), more = TRUE)
print(plot_e7b, split = c(1, 2, 1, 2), more = FALSE)
```